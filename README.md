# Powerless PC Simulator

CPU実験2015

## ビルド
```sh
> make
```

bin/ 以下に生成されます

## 実行

```sh
> ./bin/sim target.bin
```

## テストファイル(test/\*.txt)

test/ 以下にテストファイル(\*.txt)があります。makeすることで同じディレクトリに実行用のバイナリ\*.binが生成されるので、それらをシュミレータで実行することができます。
テストファイルは0, 1で書かれた命令列です。任意の空白と行中のセミコロン以降は無視されます。
実行用バイナリ生成に使用されるtxt2binは2進数で書かれた命令をそのままバイナリ化しますが、最終的にはコンパイラが出力してFPGAに焼くものと同じ形式で出力し、シミュレータ上で実行できるようにする予定です。

## 対話モード(interactive mode)

-i オプションをつけることでシミュレータは対話モードになります。
対話モードで使用できるコマンドは以下です:

### p - print 出力

レジスタに格納されたデータ、命令などを出力する

#### 汎用レジスタ
```
0x012300> p r3
(R3) = 10
```

#### 命令(16進)
```
0x012300> p ir
(R3) = 01234567
```

#### 条件レジスタ(NGZS)
```
0x012300> p cr
(CR) = 0000
```

#### リンクレジスタ(16進)
```
0x012300> p lr
(LR) = 0x000000
```

### s - step ステップ実行

次の命令を実行し、再び対話モードに移行する
```
0x012300> s
0x012304>
```

### d - disassemble 逆アセンブル
命令を逆アセンブルして表示する
```
0x012300> d
    0x012300: b     0x000070
```

### r - run 実行
ブレークポイント(未実装)に入るか終了するまで続けて命令を実行する
```
0x012300> r
simulation completed at 0x000090
317418 instructions executed
```
### q - quit 終了
- q : quit        終了
```
0x012300> q
simulation aborted at 0x012300
4 instructions executed
```

### h - help ヘルプ
- h : help        ヘルプ
